<?xml version="1.0" encoding="utf-8" ?>
<UserControl x:Class="VistaLauncher.Controls.CommandBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             Background="Transparent"
             mc:Ignorable="d">

    <UserControl.Resources>
        <ResourceDictionary>
            <!-- Hotkey Style -->
            <Style x:Key="HotkeyBorderStyle" TargetType="Border">
                <Setter Property="Padding" Value="4" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="Background" Value="{ThemeResource ControlFillColorSecondaryBrush}" />
                <Setter Property="BorderBrush" Value="{ThemeResource DividerStrokeColorDefaultBrush}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="CornerRadius" Value="6" />
                <Setter Property="MinWidth" Value="20" />
            </Style>

            <Style x:Key="HotkeyTextBlockStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="10" />
                <Setter Property="CharacterSpacing" Value="4" />
                <Setter Property="Foreground" Value="{ThemeResource TextFillColorPrimaryBrush}" />
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Setter Property="VerticalAlignment" Value="Center" />
            </Style>

            <Style x:Key="HotkeyFontIconStyle" TargetType="FontIcon">
                <Setter Property="FontSize" Value="10" />
                <Setter Property="Foreground" Value="{ThemeResource TextFillColorPrimaryBrush}" />
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Setter Property="VerticalAlignment" Value="Center" />
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid MinHeight="40" Padding="4">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <!-- Left: Settings Button -->
        <Button x:Name="SettingsButton"
                Grid.Column="0"
                Padding="4"
                Click="SettingsButton_Click"
                Style="{StaticResource SubtleButtonStyle}">
            <StackPanel Orientation="Horizontal">
                <FontIcon VerticalAlignment="Center"
                          FontSize="16"
                          Glyph="&#xE713;" />
                <TextBlock VerticalAlignment="Center"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           Text="Settings" />
            </StackPanel>
        </Button>

        <!-- Middle: Status Text -->
        <TextBlock Grid.Column="1"
                   VerticalAlignment="Center"
                   Style="{StaticResource CaptionTextBlockStyle}"
                   Text="{x:Bind StatusText, Mode=OneWay}"
                   TextTrimming="CharacterEllipsis"
                   TextWrapping="NoWrap" />

        <!-- Right: Command Buttons -->
        <StackPanel Grid.Column="2"
                    Padding="0,0,4,0"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal"
                    >

            <!-- Primary Command: Open -->
            <Button x:Name="PrimaryButton"
                    Padding="6,4,4,4"
                    AutomationProperties.AutomationId="PrimaryCommandButton"
                    AutomationProperties.Name="Open"
                    Background="Transparent"
                    Click="PrimaryButton_Click"
                    IsEnabled="{x:Bind HasSelection, Mode=OneWay}"
                    Style="{StaticResource SubtleButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock MaxWidth="160"
                               VerticalAlignment="Center"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Text="Open"
                               TextTrimming="CharacterEllipsis"
                               TextWrapping="NoWrap" />
                    <Border Style="{StaticResource HotkeyBorderStyle}">
                        <FontIcon Glyph="&#xE751;" Style="{StaticResource HotkeyFontIconStyle}" />
                    </Border>
                </StackPanel>
            </Button>

            <!-- Secondary Command: Run as Admin -->
            <Button x:Name="SecondaryButton"
                    Padding="6,4,4,4"
                    AutomationProperties.AutomationId="SecondaryCommandButton"
                    AutomationProperties.Name="Run as Administrator"
                    Click="SecondaryButton_Click"
                    IsEnabled="{x:Bind HasSelection, Mode=OneWay}"
                    Style="{StaticResource SubtleButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock MaxWidth="160"
                               VerticalAlignment="Center"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Text="Run as Administrator"
                               TextTrimming="CharacterEllipsis"
                               TextWrapping="NoWrap" />
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <Border Padding="4,2,4,2" Style="{StaticResource HotkeyBorderStyle}">
                            <TextBlock Style="{StaticResource HotkeyTextBlockStyle}" Text="Ctrl" />
                        </Border>
                        <Border Style="{StaticResource HotkeyBorderStyle}">
                            <FontIcon Glyph="&#xE751;" Style="{StaticResource HotkeyFontIconStyle}" />
                        </Border>
                    </StackPanel>
                </StackPanel>
            </Button>

            <!-- More Commands -->
            <Button x:Name="MoreButton"
                    Padding="6,4,4,4"
                    AutomationProperties.AutomationId="MoreContextMenuButton"
                    Style="{StaticResource SubtleButtonStyle}"
                    ToolTipService.ToolTip="Ctrl+K">
                <StackPanel Orientation="Horizontal">
                    <TextBlock VerticalAlignment="Center"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Text="More"
                               TextTrimming="WordEllipsis"
                               TextWrapping="NoWrap" />
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <Border Padding="4,2,4,2" Style="{StaticResource HotkeyBorderStyle}">
                            <TextBlock Style="{StaticResource HotkeyTextBlockStyle}" Text="Ctrl" />
                        </Border>
                        <Border Padding="4,2,4,2" Style="{StaticResource HotkeyBorderStyle}">
                            <TextBlock Style="{StaticResource HotkeyTextBlockStyle}" Text="K" />
                        </Border>
                    </StackPanel>
                </StackPanel>
                <Button.Flyout>
                    <MenuFlyout Placement="TopEdgeAlignedRight">
                        <MenuFlyoutItem x:Name="OpenFileLocationMenuItem" Icon="OpenLocal" Text="Open file location" Click="OpenFileLocation_Click" />
                        <MenuFlyoutItem x:Name="CopyPathMenuItem" Icon="Copy" Text="Copy path" Click="CopyPath_Click" />
                        <MenuFlyoutSeparator />
                        <MenuFlyoutItem x:Name="EditMenuItem" Icon="Edit" Text="Edit" Click="EditTool_Click" />
                        <MenuFlyoutItem x:Name="RemoveMenuItem" Icon="Delete" Text="Remove" Click="RemoveTool_Click" />
                        <MenuFlyoutSeparator />
                        <MenuFlyoutItem x:Name="AddToolMenuItem" Text="Add Tool" Click="AddTool_Click">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE710;"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Name="ImportNirLauncherMenuItem" Text="Import NirLauncher" Click="ImportNirLauncher_Click">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE8B5;"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </Button.Flyout>
            </Button>
        </StackPanel>
    </Grid>
</UserControl>
